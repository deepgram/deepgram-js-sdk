// This file was auto-generated by Fern from our API Definition.

import * as Deepgram from "../../../../src/api/index";
import { DeepgramClient } from "../../../../src/index";
import { mockServerPool } from "../../../mock-server/MockServerPool";

describe("ModelsClient", () => {
    test("list (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new DeepgramClient({
            maxRetries: 0,
            apiKey: "test",
            environment: { base: server.baseUrl, production: server.baseUrl, agent: server.baseUrl },
        });

        const rawResponseBody = {
            stt: [
                {
                    name: "nova-3",
                    canonical_name: "nova-3",
                    architecture: "base",
                    languages: ["en", "en-us"],
                    version: "2021-11-10.1",
                    uuid: "6b28e919-8427-4f32-9847-492e2efd7daf",
                    batch: true,
                    streaming: true,
                    formatted_output: true,
                },
            ],
            tts: [
                {
                    name: "zeus",
                    canonical_name: "aura-2-zeus-en",
                    architecture: "aura-2",
                    languages: ["en", "en-US"],
                    version: "2025-04-07.0",
                    uuid: "2baf189d-91ac-481d-b6d1-750888667b31",
                    metadata: {
                        accent: "American",
                        age: "Adult",
                        color: "#C58DFF",
                        image: "https://static.deepgram.com/examples/avatars/zeus.jpg",
                        sample: "https://static.deepgram.com/examples/Aura-2-zeus.wav",
                        tags: ["masculine", "deep", "trustworthy", "smooth"],
                        use_cases: ["IVR"],
                    },
                },
            ],
        };
        server.mockEndpoint().get("/v1/models").respondWith().statusCode(200).jsonBody(rawResponseBody).build();

        const response = await client.manage.v1.models.list({
            include_outdated: true,
        });
        expect(response).toEqual({
            stt: [
                {
                    name: "nova-3",
                    canonical_name: "nova-3",
                    architecture: "base",
                    languages: ["en", "en-us"],
                    version: "2021-11-10.1",
                    uuid: "6b28e919-8427-4f32-9847-492e2efd7daf",
                    batch: true,
                    streaming: true,
                    formatted_output: true,
                },
            ],
            tts: [
                {
                    name: "zeus",
                    canonical_name: "aura-2-zeus-en",
                    architecture: "aura-2",
                    languages: ["en", "en-US"],
                    version: "2025-04-07.0",
                    uuid: "2baf189d-91ac-481d-b6d1-750888667b31",
                    metadata: {
                        accent: "American",
                        age: "Adult",
                        color: "#C58DFF",
                        image: "https://static.deepgram.com/examples/avatars/zeus.jpg",
                        sample: "https://static.deepgram.com/examples/Aura-2-zeus.wav",
                        tags: ["masculine", "deep", "trustworthy", "smooth"],
                        use_cases: ["IVR"],
                    },
                },
            ],
        });
    });

    test("list (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new DeepgramClient({
            maxRetries: 0,
            apiKey: "test",
            environment: { base: server.baseUrl, production: server.baseUrl, agent: server.baseUrl },
        });

        const rawResponseBody = { key: "value" };
        server.mockEndpoint().get("/v1/models").respondWith().statusCode(400).jsonBody(rawResponseBody).build();

        await expect(async () => {
            return await client.manage.v1.models.list();
        }).rejects.toThrow(Deepgram.BadRequestError);
    });

    test("get (1)", async () => {
        const server = mockServerPool.createServer();
        const client = new DeepgramClient({
            maxRetries: 0,
            apiKey: "test",
            environment: { base: server.baseUrl, production: server.baseUrl, agent: server.baseUrl },
        });

        const rawResponseBody = {
            name: "general",
            canonical_name: "enhanced-general",
            architecture: "polaris",
            languages: ["en", "en-us"],
            version: "2022-05-18.1",
            uuid: "c7226e9e-ae1c-4057-ae2a-a71a6b0dc588",
            batch: true,
            streaming: true,
            formatted_output: false,
        };
        server
            .mockEndpoint()
            .get("/v1/models/af6e9977-99f6-4d8f-b6f5-dfdf6fb6e291")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.manage.v1.models.get("af6e9977-99f6-4d8f-b6f5-dfdf6fb6e291");
        expect(response).toEqual({
            name: "general",
            canonical_name: "enhanced-general",
            architecture: "polaris",
            languages: ["en", "en-us"],
            version: "2022-05-18.1",
            uuid: "c7226e9e-ae1c-4057-ae2a-a71a6b0dc588",
            batch: true,
            streaming: true,
            formatted_output: false,
        });
    });

    test("get (2)", async () => {
        const server = mockServerPool.createServer();
        const client = new DeepgramClient({
            maxRetries: 0,
            apiKey: "test",
            environment: { base: server.baseUrl, production: server.baseUrl, agent: server.baseUrl },
        });

        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .get("/v1/models/model_id")
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.manage.v1.models.get("model_id");
        }).rejects.toThrow(Deepgram.BadRequestError);
    });
});
